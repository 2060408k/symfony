# The User Object

Now in addition to checking whether or not a user has a specific role, we'd also figure out who is logged in. What I'm talking about is what user object is logged in so we can actually ask Symphony to return to us the entire user object that's logged in. Then we can use whatever data that we've chosen to store on a user object. It's done a new action just to prove we can do this, let's update our flash methods to include the email address of who just created that Genus. We'll change them as to Genus created you and are amazing and we'll hack in the email address and we'll say this arrow get user. That's it, this returns our user entity object and then we can call get email on that or whatever other methods we have now. Let's actually make sure we have a get email method on our user objects and actually we don't.

I don't have a get a yet for our email property. Let's go down to the bottom and add one, perfect. I'll head back, create another sea monster, save and there it is. That's really easy, I do want you to know what's really happening behind the scenes. You'll hold the command and click get user. The important thing here is that the user comes from a service called security.tokenstorage. This actually returns a token object and from there you call user equals token arrow get user. Now there is one very important quack which you don't have to worry about in many cases but you may eventually and that's this. When you're logged in anonymously and you ... When you want to get the user directly from this service, what you might need to do in a service some day, you will say token equals token storage arrow get token.

Then you'll say user equals token get user. If you are anonymous, if you're not logged in, the user in that case will actually be a string, A-N-O-N, not null. That means when you, if you do get your user object directly from the service this way, you're going to want to check to make sure that user is an object. That's the only way that you can know for sure that this is actually your user object and not that silly string. Now in Twig you can also get the user object. In fact let's talk about security in general in Twig. First, open up your base template. Earlier on in this course we actually already showed how to do authorization inside of your template. It's the is_granted function and that's the exact same thing that we just used in our controller. Boom, there it is, super easy. Second, how do we get the user object? Well let's go to the homepage. We're in this nice welcome aquanauts here, let's replace that with the email address of the user if we know what it is.

Welcome and we'll say app that user? We'll say app that user and that will give you the user object so the app variables are global variables and this has a couple of things on it and it gives you the user object. We want to use that in an IF statement and say app.user.email otherwise let's prompt in aquanauts. I'm coding carefully here because the user might not be logged in on this page so I need to be careful. Another way I could have done this is with an if is granted call for a world user and then I would know whether or not they were logged in or not. Head to the home page, there it is.
