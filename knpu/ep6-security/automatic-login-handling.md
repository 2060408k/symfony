# Automatic Login Handling

If I filled this form in right now, it would register me but it wouldn't actually log me in which is lame. Let's fix that, because we're using guard authentication, this is incredibly easy. Inside of user controller instead of redirecting the home page, I want you to do this. Return this [error get 00:00:30], find a service called security.authentication.guardhandleit. It has a method on it called authentic user and handle success. Actually going to clear out the arguments here and go on another line. This is a very powerful function because it's going to allow us to manually authenticate the user, and it's going to automatically redirect the user using whatever normal log-in logic our authenticator has.

I'll show you what I mean. First, let's fill this in. The first argument is the user so that's user, second argument is the request so that's your request. The third argument is the authenticator that we want to mimic so I'll go to services.yml, copy the service name for our authenticator then we'll just get that here with this arrow, get and then paste. Last argument is something called a provider key, that's something you'll see occasionally in security. It's a fancy way of saying the name of our firewall so name. The name of your firewall's almost never important but it actually is in this case. We'll say name and that's it.

As I mentioned, this is going to do two things. It's going to authenticate us, it's also going to redirect us back. It's going to redirect us to the proper place and, specifically, it's going to redirect us to the page that we tried to visit before authentication was forced. For example, we are anonymous right now so what if we try to go to admin/genus? Oh we can't so it takes us to the log-in page. That's fine, we actually don't want to log in, we want to register. Let's register as [webrianplus 00:02:34]20@gmail.com. Password [fill 00:02:38], hit enter and check this out. Ignore the access denied screen, pay attention to a couple of things.

First, we are logged in as that new user and second, it redirected us back to the URL we were trying to visit before. This is really great because it means that if the user suddenly goes to a page like your checkout page, and then gets bounced to the log-in and ends up registering, they will get sent back to the checkout page which is a heck of a lot more useful. Of course, we see the access denied because this user only has role user and this section requires role admin, but that's not really a problem. All right guys, that's it. Yes, you can get more complicated with security especially on authentication.

You can use JSON Web Tokens, you can use social authentication, those are things that are really fun to implement. On the authorization side, you can build [filters 00:03:45] and that can make your authorization logic much more powerful. For the most part, you guys have the tools to do really incredible things so go out there, build something awesome and tell me about it. See you next time.

